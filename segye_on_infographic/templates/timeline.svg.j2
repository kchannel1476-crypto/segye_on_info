{% import "_tokens.j2" as T %}
<svg xmlns="http://www.w3.org/2000/svg" width="{{ canvas.w }}" height="{{ canvas.h }}" viewBox="0 0 {{ canvas.w }} {{ canvas.h }}">
  <defs>
    {{ T.common_styles() }}
  </defs>

  {% include "_tokens.j2" %}
  <rect class="bg" x="0" y="0" width="{{ W }}" height="{{ H }}"/>

  <!-- Header -->
  <text class="h1 ink" x="{{ x0 }}" y="{{ m + 72 }}">{{ text.headline }}</text>
  {% if text.dek %}
    <text class="dek muted" x="{{ x0 }}" y="{{ m + 120 }}">{{ text.dek }}</text>
  {% endif %}
  <line class="hair" x1="{{ x0 }}" y1="{{ header_line_y }}" x2="{{ x1 }}" y2="{{ header_line_y }}"/>

  <!-- Body split: left 7col timeline / right 5col key points -->
  {% set left_x = x0 %}
  {% set left_w = (x1 - x0) * 0.62 %}
  {% set right_x = x0 + left_w + 24 %}
  {% set right_w = x1 - right_x %}

  <!-- Timeline label -->
  <text class="label ink" x="{{ left_x }}" y="{{ body_top }}">타임라인</text>

  <!-- Timeline spine -->
  {% set spine_x = left_x + 18 %}
  {% set t_start = body_top + 40 %}
  {% set t_end = footer_line_y - 40 %}
  <line x1="{{ spine_x }}" y1="{{ t_start }}" x2="{{ spine_x }}" y2="{{ t_end }}" stroke="#dddddd" stroke-width="6"/>

  {% set base_y = body_top + 86 %}
  {% for item in text.timeline %}
    {% set idx = loop.index0 %}
    {% set yy = base_y + (idx * 96) %}
    {% if yy < footer_line_y - 40 %}
      <circle cx="{{ spine_x }}" cy="{{ yy - 10 }}" r="10" fill="#111111"/>
      <text class="small muted" x="{{ spine_x + 28 }}" y="{{ yy - 18 }}">{{ item.date }}</text>
      <text class="body ink" x="{{ spine_x + 28 }}" y="{{ yy + 22 }}">{{ item.event }}</text>
    {% endif %}
  {% endfor %}

  <!-- Right: key points -->
  <rect class="box" x="{{ right_x }}" y="{{ body_top - 10 }}" width="{{ right_w }}" height="520" rx="18"/>
  <text class="label ink" x="{{ right_x + 24 }}" y="{{ body_top + 60 }}">핵심</text>

  {% set kpy = body_top + 140 %}
  {% for i in range(3) %}
    {% set yy = kpy + (i * 96) %}
    <circle cx="{{ right_x + 30 }}" cy="{{ yy - 10 }}" r="6" fill="#111111"/>
    <text class="body ink" x="{{ right_x + 54 }}" y="{{ yy }}">{{ text.key_points[i] }}</text>
  {% endfor %}

  <!-- Footer -->
  <line class="hair" x1="{{ x0 }}" y1="{{ footer_line_y }}" x2="{{ x1 }}" y2="{{ footer_line_y }}"/>
  <text class="small muted" x="{{ x0 }}" y="{{ sources_y }}">{{ text.sources_line }}</text>
</svg>
